# YOLOv5 ğŸš€ by Ultralytics, AGPL-3.0 license
# KAIST Multispectral Pedestrian Detection Dataset ìµœì í™” í•˜ì´í¼íŒŒë¼ë¯¸í„°
# ì‚¬ìš©ë²•: python train.py --batch 16 --cfg models/custom_models/mymodel_cbam.yaml --weights '' --data kaist-rgbt.yaml --hyp data/hyps/hyp.kaist-rgbt.yaml

# í•™ìŠµë¥  ì„¤ì • (ë©€í‹°ëª¨ë‹¬ íŠ¹ì„± ê³ ë ¤)
lr0: 0.005 # ì´ˆê¸° í•™ìŠµë¥  (ë” ì‘ê²Œ ì„¤ì • - RGB/Thermal ê· í˜•)
lrf: 0.1 # ìµœì¢… í•™ìŠµë¥  ë¹„ìœ¨
momentum: 0.937 # SGD momentum
weight_decay: 0.0005 # ê°€ì¤‘ì¹˜ ê°ì‡  (ì •ê·œí™” ê°•í™”)
warmup_epochs: 5.0 # warmup ê¸°ê°„ í™•ëŒ€ (ì•ˆì •ì  í•™ìŠµ)
warmup_momentum: 0.8 # warmup ì´ˆê¸° momentum
warmup_bias_lr: 0.1 # warmup ì´ˆê¸° bias í•™ìŠµë¥ 

# ì†ì‹¤ í•¨ìˆ˜ ê°€ì¤‘ì¹˜ (ë³´í–‰ì ê²€ì¶œ íŠ¹í™”)
box: 0.06 # bbox loss ê°€ì¤‘ì¹˜ (ì‘ì€ ê°ì²´ ê°•ì¡°)
cls: 0.4 # ë¶„ë¥˜ loss ê°€ì¤‘ì¹˜ (4 í´ë˜ìŠ¤ ê³ ë ¤)
cls_pw: 1.0 # ë¶„ë¥˜ positive weight
obj: 0.8 # ê°ì²´ì„± loss ê°€ì¤‘ì¹˜ (ê°ì²´ ê²€ì¶œ ê°•ì¡°)
obj_pw: 1.0 # ê°ì²´ì„± positive weight
iou_t: 0.20 # IoU ì„ê³„ê°’
anchor_t: 4.0 # anchor ë°°ìˆ˜ ì„ê³„ê°’
fl_gamma: 0.0 # focal loss gamma

# HSV ì¦ê°• (ë©€í‹°ëª¨ë‹¬ ë°ì´í„° ê³ ë ¤)
hsv_h: 0.010 # ìƒ‰ì¡° ì¦ê°• (thermal í˜¸í™˜ì„±)
hsv_s: 0.5 # ì±„ë„ ì¦ê°• (thermalì—ì„œ ì˜ë¯¸ ìˆìŒ)
hsv_v: 0.3 # ëª…ë„ ì¦ê°• (ì¡°ëª… ì¡°ê±´ ë‹¤ì–‘í™”)

# ê¸°í•˜í•™ì  ì¦ê°• (ë³´í–‰ì í¬ì¦ˆ ë³´ì¡´)
degrees: 3.0 # íšŒì „ ê°ë„ (ì‘ê²Œ ì„¤ì •)
translate: 0.1 # í‰í–‰ì´ë™ ë¹„ìœ¨
scale: 0.2 # ìŠ¤ì¼€ì¼ ë³€í™” (ë³´í–‰ì í¬ê¸° ë‹¤ì–‘í™”)
shear: 2.0 # ì „ë‹¨ ë³€í˜• (ì‘ê²Œ ì„¤ì •)
perspective: 0.0001 # ì›ê·¼ ë³€í˜• (ìµœì†Œí™”)

# í”Œë¦½ ì¦ê°•
flipud: 0.0 # ìƒí•˜ í”Œë¦½ (ë³´í–‰ìëŠ” í•­ìƒ ì§ë¦½)
fliplr: 0.5 # ì¢Œìš° í”Œë¦½ (ì¢Œìš° ëŒ€ì¹­ì„± í™œìš©)

# ê³ ê¸‰ ì¦ê°• (ë©€í‹°ëª¨ë‹¬ íŠ¹ì„± ê³ ë ¤) - ì•ˆì •í™”
mosaic: 0.5 # ëª¨ìì´í¬ í™•ë¥  (ì•ˆì •ì„±ì„ ìœ„í•´ ê°ì†Œ)
mixup: 0.0 # ë¯¹ìŠ¤ì—… ë¹„í™œì„±í™” (RGB-T íŠ¹ì„± ë³´ì¡´)
copy_paste: 0.05 # ë³µì‚¬-ë¶™ì—¬ë„£ê¸° (ì•ˆì •ì„±ì„ ìœ„í•´ ê°ì†Œ)

# KAIST íŠ¹í™” ì¶”ê°€ íŒŒë¼ë¯¸í„°
# í´ë˜ìŠ¤ë³„ ê°€ì¤‘ì¹˜ (person > people > cyclist > person?)
class_weights: [1.0, 0.8, 0.9, 0.6]
# ì‘ì€ ê°ì²´ ê°•ì¡° ê³„ìˆ˜
small_object_weight: 1.5
# ë©€í‹°ëª¨ë‹¬ ìœµí•© ê°€ì¤‘ì¹˜
fusion_weight_rgb: 0.6
fusion_weight_thermal: 0.4
# ì•¼ê°„/ì €ì¡°ë„ ì¡°ê±´ ê°•ì¡°
low_light_enhancement: True
# Thermal ë…¸ì´ì¦ˆ ì‹œë®¬ë ˆì´ì…˜
thermal_noise_std: 15.0
